#!/bin/env bash

# List all accounts(subscriptions), and highlight the default one
#
# The original command is like
#   az account list -otable --query "[].{Default: isDefault, Name: name, ID: id}" | sed '/True/s/.*/printf "\\e[32m\0\\e[0m"/e'
# It needs to be quoted properly
az account list -otable --query "[].{Default: isDefault, Name: name, ID: id}" | sed '/True/s/.*/printf "\\e[32m\0\\e[0m"/e'

DIR=$( cd "$( dirname "$0" )" && pwd )

# Save the list to a JSON file
# So it could be utilized by other scripts
subListFile="${DIR}/../data/subscription-list.localonly.json"
az account list --query="[].{name:name, id:id}" -ojson > "$subListFile"

printf '%s' "
Subscription list saved to: $(readlink -f "$subListFile")

You can PIM up with commands like:

az-pim sub-name \"Contributor\" 1 \"Deploy stuff\" \"JIRA\" \"TICKET-12345\"
az-pim sub-name \"Reader\" 1

"
